<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Exports</title>
<link rev="made" href="mailto:" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#exports">Exports</a></li>
	<ul>

		<li><a href="#synopsis">Synopsis</a></li>
		<li><a href="#description">Description</a></li>
		<li><a href="#method:_exports">Method: Exports</a></li>
		<li><a href="#credits">Credits</a></li>
		<ul>

			<li><a href="#author">Author</a></li>
			<li><a href="#copyright">Copyright</a></li>
			<li><a href="#license">License</a></li>
		</ul>

	</ul>

</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="exports">Exports</a></h1>
<p>
</p>
<h2><a name="synopsis">Synopsis</a></h2>
<pre>
 use Math::Zap::Vector vector=&gt;'v', units=&gt;'u';</pre>
<pre>
 my $x = v(1,0,0);
 my $y = u();</pre>
<p>Rather than:</p>
<pre>
 my $x = Math::Zap::Vector::vector(1,0,0);
 my $y = Math::Zap::Vector::units();</pre>
<p>
</p>
<h2><a name="description">Description</a></h2>
<p>Export routines from a package with names specified by caller of the
package. The routines to be exported are defined in the exporting
package Math::Zap::As:
$VERSION=1.03;</p>
<pre>
 use Math::Zap::Exports qw(
   vector ($$$)
   units  ()
 );</pre>
<p>A suitable sub <code>import()</code> is created, allowing the caller to specify:</p>
<pre>
 use Math::Zap::Vector vector=&gt;'v', units=&gt;'u';</pre>
<p>The caller may then refer to Math::Zap::Vector::vector() as <code>v()</code> and
Math::Zap::Vector::units() as u().</p>
<p>The first routine exported is always imported by its export name unless
a new name is supplied. Thus:</p>
<pre>
 use Math::Zap::Vector;</pre>
<p>and</p>
<pre>
 use Math::Zap::Vector vector=&gt;'vector';</pre>
<p>have identical effects.</p>
<p>The advantage of this is approach is that it allows the importing
package Math::Zap::To control the names of the exported routines in its name space
$VERSION=1.03;
rather than the developer of the exporting package, a facility I have
not been able to discover in the standard Perl Exporter.pm.
</p>
<pre>

PhilipRBrenan@yahoo.com, 2004, Perl licence</pre>
<p>
</p>
<h2><a name="method:_exports">Method: Exports</a></h2>
<p>Construct import routine.</p>
<pre>
 
 ##1
 package Math::Zap::Exports;
 $VERSION=1.03;
 
 #______________________________________________________________________
 # Import for exports: export from exporting package.
 #______________________________________________________________________
 
 sub import(@)
  {shift @_;               # Remove 'exports'
   scalar(@_) % 2 and      # Check number of parameters is even
     die &quot;use exports: Odd number of parameters&quot;;
   my $q = join(' ', @_);  # Stringify parameters
   my $p = (caller())[0];  # Exporting package
   my $s =                 # Push data into space of exporting package 
 '@'.$p.'::EXPORTS = qw('.$q.');';
   eval $s; die $@ if $@;  # Perform push and check it worked
 # print &quot;AAAA &quot;, join(' ', @zzz::EXPORTS), &quot;\n&quot;; # Print pushed data
 
 #______________________________________________________________________
 # Construct import routine for exporting package.
 #______________________________________________________________________
 
   $s  = 'pack'.&quot;age $p;\n&quot;. &lt;&lt;'END'; # Switch to exporting package
 sub import(@)
  {shift @_;
   my @p = ($EXPORTS[0], $EXPORTS[0], @_);
   scalar(@p) % 2 and die &quot;Odd number of parameters&quot;;
 
 # Edit parameters and convert to hash
   s/^-// for(@p);
   my %p = @p;
 
 # Switch to package requesting exported methods
   my $c = __PACKAGE__;    # Save exporting package
   my $s =                 # Switch to importing package   
 'pack'.'age '.(caller())[0].&quot;;\n&quot;.
 'no warnings \'redefine\';'.&quot;\n&quot;;
 
 # Export valid methods
   my %e = @EXPORTS;
   for my $p(keys(%p))
    {defined $e{$p} or
       die &quot;use $c: Bad method: $p requested.\nValid methods are &quot;.
           join(', ', sort(keys(%e))). &quot;\n&quot;;
     $s .= 'sub '.$p{$p}.$e{$p}.' {&amp;'.$c.'::'.$p.'(@_)}'.&quot;\n&quot;;
    }
 
 # Back to exporting package
   $s .= 'use warnings \'redefine\';'.&quot;\n&quot;.
         'pack'.'age '.$c.&quot;;\n&quot;;
 
 # Push exports
 # print &quot;BBBB $s\n&quot;;
   eval($s); die $@ if $@;
  }
 END
 
 #______________________________________________________________________
 # Push import routine  
 #______________________________________________________________________
 
 # print &quot;CCCC $s\n&quot;;
   eval($s); die $@ if $@;
  }
 
 ##2
 #______________________________________________________________________
 # Package installed successfully
 #______________________________________________________________________
 
 1;</pre>
<p>
</p>
<h2><a name="credits">Credits</a></h2>
<p>
</p>
<h3><a name="author">Author</a></h3>
<p><a href="mailto:philiprbrenan@yahoo.com">philiprbrenan@yahoo.com</a></p>
<p>
</p>
<h3><a name="copyright">Copyright</a></h3>
<p><a href="mailto:philiprbrenan@yahoo.com,">philiprbrenan@yahoo.com,</a> 2004</p>
<p>
</p>
<h3><a name="license">License</a></h3>
<p>Perl License.

</p>

</body>

</html>
